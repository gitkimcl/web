<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="style.css">
		<script src="jquery.js"></script>
	</head>
	<body>
		<div class="wall"></div>
		<div class="overlay">
			<div style="height:15vh;"></div>
			<div style="zoom: 1.5">
				<h1>벽 타이머</h1>
			<span>완공 시간:</span>
			<input type="text" id="year" pattern="[1-9]\d{0,3}" placeholder="1">
			<span>년 </span>
			<input type="text" id="month" pattern="[1-9]|1[0-2]" placeholder="1">
			<span>월 </span>
			<input type="text" id="day" pattern="[1-9]|[1-2]\d|3[0-1]" placeholder="1">
			<span>일 </span>
			<input type="text" id="hour" pattern="\d|1\d|2[0-3]" placeholder="0">
			<span>시</span>
			<br>
			<span>공사 기간:</span>
			<input type="text" id="time" pattern="[1-9]\d{0,2}" placeholder="0">
			<select id="unit">
				<option value="3600">시간</option>
				<option value="86400">일</option>
				<option value="604800">주</option>
				<option value="31536000">년</option>
			</select>
			<br>
			<button id="start">
				<image style="height:50px; margin: 5px;" src="hammer.png" alt="킹작권"></image>
				<p style="font-weight: bold; color:#00BBFF;">
					공사 시작
				</p>
			</button>
			<p class="warning" style="color: #00BBFF; font-weight: bold;"></p>
			</div>
		</div>
	</body>
	<script>
		var i,j;
		var $line, $brick;
		var year="",month="",day="",hour="";
		$("#year").on("propertychange change keyup paste input", function() {
			if (!document.getElementById("year").checkValidity()) {
				$("#year").val(year);
			} else {
				year=$("#year").val();
				if (month==2) {
					if (year%4==0) {
						if (year%100==0) {
							if (year%400==0) {
								$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-9]");
							} else {
								$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-8]");
							}
						} else {
							$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-9]");
						}
					} else {
						$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-8]");
					}
				}
				checkDay(true);
			}
		});
		$("#month").on("propertychange change keyup paste input", function() {
			if (!document.getElementById("month").checkValidity()) {
				$("#month").val(month);
			} else {
				month=$("#month").val();
				if (month==2) {
					if (year%4==0) {
						if (year%100==0) {
							if (year%400==0) {
								$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-9]");
							} else {
								$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-8]");
							}
						} else {
							$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-9]");
						}
					} else {
						$("#day").attr("pattern","[1-9]|[1][0-9]|2[0-8]");
					}
				} else if (month==""||isNaN(month)||(month<=7&&month%2==1)||(month>=8&&month%2==0)) {
					$("#day").attr("pattern","[1-9]|[1-2][0-9]|3[0-1]");
				} else {
					$("#day").attr("pattern","[1-9]|[1-2][0-9]|30");
				}
				checkDay(true);
			}
		});
		function checkDay(erase) {
			if (!document.getElementById("day").checkValidity()) {
				if (erase) {
					$("#day").val("");
				} else {
					$("#day").val(day);
				}
			} else {
				day=$("#day").val();
			}
		}
		$("#day").on("propertychange change keyup paste input", function() {
			checkDay(false);
		});
		$("#hour").on("propertychange change keyup paste input", function() {
			if (!document.getElementById("hour").checkValidity()) {
				$("#hour").val(hour);
			} else {
				hour=$("#hour").val();
			}
		});
		$("#time").on("propertychange change keyup paste input", function() {
			if (!document.getElementById("time").checkValidity()) {
				$("#time").val(time);
			} else {
				time=$("#time").val();
			}
		});
		for (i=0; i<50; i++) {
			$line=$("<div>");
			$line.addClass("line");
			if (i%2==1) {
				$line.addClass("even");
				$line.append($("<brick>"));
			}
			for (j=0; j<50; j++) {
				$brick=$("<brick>");
				$line.append($brick);
			}
			$(".wall").append($line);
		}
		$(".even brick:nth-child(1)").addClass("half");
		$(".even brick:nth-child(1)").addClass("no-left");
		$(".even brick:nth-last-child(1)").addClass("half");
		$(".even brick:nth-last-child(1)").addClass("no-right");
		$("#start").click(function() {
			if ($("#year").val()==""||$("#month").val()==""||$("#day").val()==""||$("#hour").val()==""||$("#time").val()=="") {
				$(".warning").text("양식을 기입해 주십시오");
				return;
			}
			$(".warning").text("공사 현장으로 이동 중입니다");
			var sec=$("#time").val()*$("#unit").val();
			window.location="timer.html?y="+$("#year").val()+"&m="+$("#month").val()+"&d="+$("#day").val()+"&h="+$("#hour").val()+"&s="+sec;
		});
	</script>
</html>