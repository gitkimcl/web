<!DOCTYPE html>
<html>
	<head>
		<title>LOADING</title>
		<link rel="stylesheet" href="style.css">
		<link rel="stylesheet" href="gooeyMenu.css">
		<link rel="shortcut icon" href="favicon.ico">
		<script src="https://kit.fontawesome.com/10d1dd4434.js" crossorigin="anonymous"></script>
		<script src="jquery.js">//JQuery</script>
	</head>
	<body>
		<div id="blinder" class="special"></div>
		<nav class="menu">
			<input type="checkbox" href="#" class="menu-open" name="menu-open" id="menu-open" onchange="flipSpecial()"/>
			<label class="menu-open-button" for="menu-open">
				<span class="icon icon-1"></span>
				<span class="icon icon-2"></span>
			</label>
			<button id="day1" class="menu-item" onclick="buttonClicked(1)"> <span class="lato">1</span> </button>
			<button id="day2" class="menu-item" onclick="buttonClicked(2)"> <span class="lato">2</span> </button>
			<button id="day3" class="menu-item" onclick="buttonClicked(3)"> <span class="lato">3</span> </button>
			<button id="day4" class="menu-item" onclick="buttonClicked(4)"> <span class="lato">4</span> </button>
			<button id="day5" class="menu-item" onclick="buttonClicked(5)"> <span class="lato">5</span> </button>
			<button id="day6" class="menu-item" onclick="buttonClicked(6)"> <span class="lato">6</span> </button>
			<button id="day7" class="menu-item" onclick="buttonClicked(7)"> <span class="lato">7</span> </button>
		</nav>
		<!-- filters -->
		<svg class="filter" xmlns="http://www.w3.org/2000/svg" version="1.1">
			<defs>
				<filter id="shadowed-goo">
					<feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="10" />
					<feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="goo" />
					<feGaussianBlur in="goo" stdDeviation="3" result="shadow" />
					<feColorMatrix in="shadow" mode="matrix" values="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 -0.2" result="shadow" />
					<feOffset in="shadow" dx="1" dy="1" result="shadow" />
					<feComposite in2="shadow" in="goo" result="goo" />
				<feComposite in2="goo" in="SourceGraphic" result="mix" />
				</filter>
				<filter id="goo">
					<feGaussianBlur in="SourceGraphic" result="blur" stdDeviation="10" />
					<feColorMatrix in="blur" mode="matrix" values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7" result="goo" />
					<feComposite in2="goo" in="SourceGraphic" result="mix" />
				</filter>
			</defs>
		</svg>
		<div class="container">
			<span id="hour1" class="number">LO</span>
			<span id="hour2" class="number">A</span>
			<span id="c1" class="colon">:</span>
			<span id="min1" class="number">D</span>
			<span id="min2" class="number"></span>
			<br id="lf">
			<span id="c2" class="colon">:</span>
			<span id="sec1" class="number">IN</span>
			<span id="sec2" class="number">G</span>
		</div>
		<script>
			//initial
			function _timeLapse(num) {
				_offset+=(num-1)*51;
			}
			function _rewind(num) {
				_offset-=(num+1)*51;
			}
			function buttonClicked(num) {
				if (diff<1) return;
				target=new Date(today);
				target.setHours(num*24,0,0,0);
				localStorage.setItem("target",target);
			}
			var target=localStorage.getItem("target");
			if (target===null) {
				target=new Date();
				target.setHours(24,0,0,0);
			}
			target=new Date(target);
			if (target<new Date()) {
				target=new Date();
				target.setHours(24,0,0,0);
			}
			localStorage.setItem("target",target);
		</script>
		<script>
			function mixColor(c1,c2,ratio) {
				if (ratio<0) ratio=0;
				else if (ratio>1) ratio=1;
				var R,G,B;
				R=Math.floor((c1[0]*(1-ratio))+(c2[0]*ratio));
				G=Math.floor((c1[1]*(1-ratio))+(c2[1]*ratio));
				B=Math.floor((c1[2]*(1-ratio))+(c2[2]*ratio));
				var result = [R,G,B];
				return result;
			}
			function arrayToRGB(array) {
				return "rgb("+array[0]+","+array[1]+","+array[2]+")";
			}
			function twoDigit(num) {
				if (num<10) {
					return "0"+num;
				} else {
					return num;
				}
			}
			var _special = false
			function flipSpecial() {
				_special = !_special
				if (_special) {
					$("#blinder").addClass("opaque");
				} else {
					$("#blinder").removeClass("opaque")
				}
			}
		</script>
		<script>
			var _offset=0;
			var code;
			var today;
			var diff;
			var timeLeft;
			function loop() {
				var now=new Date();
				now.setMilliseconds(_offset);
				today=new Date(now);
				today.setHours(0,0,0,0);
				diff=(target-today)/86400000;
				$(".menu-item").removeClass("checked");
				$("#day"+diff).addClass("checked");
				if (diff==1) {
					$(".menu-open-button").addClass("checked");
				} else {
					$(".menu-open-button").removeClass("checked");
				}
				timeLeft=Math.ceil((target-now)/1000);
				var hour=Math.floor(timeLeft/3600);
				var min=Math.floor(timeLeft/60)%60;
				var sec=timeLeft%60;
				hour=twoDigit(hour);
				min=twoDigit(min);
				sec=twoDigit(sec);
				if (hour!=0) {
					$("title").text("Timer - "+hour+":"+min+":"+sec);
				} else if (min!=0) {
					$("title").text("Timer - "+min+":"+sec);
				} else {
					$("title").text("Timer - "+sec)
				}
				var ratio=timeLeft/604800;
				var color1=mixColor([255,34,34],[143,81,144],ratio);
				var color2=mixColor([32,128,255],[143,81,144],ratio);
				$("body").css("background","linear-gradient(225deg,"+arrayToRGB(color1)+","+arrayToRGB(color2)+")");
				$("#hour1").text(Math.floor(timeLeft/36000));
				$("#hour2").text(Math.floor(timeLeft%36000/3600));
				$("#min1").text(Math.floor(timeLeft%3600/600));
				$("#min2").text(Math.floor(timeLeft%600/60));
				$("#sec1").text(Math.floor(timeLeft%60/10));
				$("#sec2").text(timeLeft%10);
				if (timeLeft<360000) {
					$("#lf").css("display","none");
					if (timeLeft<36000) {
						$("#hour1").addClass("disable");
						if (timeLeft<3600) {
							$("#hour1,#hour2,#c1").css("display","none");
							$("#min1,#min2,#c2,#sec1,#sec2").css("font-size","30vw");
							if (timeLeft<600) {
								$("#min1").addClass("disable");
								if (timeLeft<60) {
									$("#blinder").addClass("opaque");
									$("#min1,#min2,#c2").css("display","none");
									$("#sec1,#sec2").css("font-size","50vw");
									if (timeLeft<10) {
										$("#sec1").css("display","none");
									} else {
										$("#sec1").css("display","inline-block");
									}
								} else {
									$("#min1,#min2,#c2").css("display","inline-block");
									$("#sec1,#sec2").css("font-size","30vw");
								}
							} else {
								$("#min1").removeClass("disable");
							}
						} else {
							$("#hour1,#hour2,#c1").css("display","inline-block");
							$("#min1,#min2,#c1,#sec1,#sec2").css("font-size","20vw");
						}
					} else {
						$("#hour1").removeClass("disable");
					}
				} else {
					$("#lf").css("display","block");
					$("#hour1").removeClass("disable");
				}
				if (timeLeft>60) {
					if (!_special) {
						$("#blinder").removeClass("opaque");
					}
				}else if (timeLeft<0) {
					$(".menu-open-button").removeClass("checked");
					$(".menu-item").removeClass("checked");
					$("#day1").addClass("purple");
					$(".menu-open-button").addClass("purple");
					$("#sec2").text("0");
					$("title").text("Timer - REFRESH TO RESTART")
					clearInterval(code);
				}
			}
			code=setInterval(loop,51);
		</script>
	</body>
</html>